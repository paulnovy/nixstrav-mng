<!doctype html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>nixstrav-mng</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header class="topbar">
        <div class="brand">
            <span class="logo-dot"></span>
            <span class="brand-text">nixstrav-mng</span>
        </div>
        <nav class="nav">
            <a href="/">Dashboard</a>
            <a href="/tags">Tagi</a>
            <a href="/enroll">Enroll</a>
            <a href="/events">Zdarzenia</a>
            <a href="/system">System</a>
            {% if user and user.role == 'admin' %}
                <a href="/settings/users">Użytkownicy</a>
            {% endif %}
        </nav>
        <div class="userbox">
            <button class="theme-toggle" id="theme-toggle" type="button" title="Przełącz motyw">☀︎</button>
            {% if user %}
                <span class="user-role">{{ user.role }}</span>
                <form method="post" action="/logout" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                    <button class="linklike" type="submit">Wyloguj</button>
                </form>
            {% else %}
                <a href="/login">Zaloguj</a>
            {% endif %}
        </div>
    </header>
    <main class="content">
        {% block content %}{% endblock %}
    </main>
    <script>
        const root = document.documentElement;
        const toggle = document.getElementById('theme-toggle');
        const stored = localStorage.getItem('theme');
        if (stored) root.dataset.theme = stored;
        function setIcon() {
            const theme = root.dataset.theme || 'dark';
            toggle.textContent = theme === 'light' ? '☾' : '☀︎';
        }
        toggle?.addEventListener('click', () => {
            const current = root.dataset.theme || 'dark';
            const next = current === 'light' ? 'dark' : 'light';
            root.dataset.theme = next;
            localStorage.setItem('theme', next);
            setIcon();
        });
        setIcon();
    </script>
</body>
</html>
